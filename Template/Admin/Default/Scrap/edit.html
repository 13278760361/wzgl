<!DOCTYPE html>
<html>
 
	<head> 
		<meta charset="UTF-8"> 
		<meta name="keywords" content="">
		<meta name="author" content="xx_xh">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<link rel="stylesheet" type="text/css" href="__CSS__/bootstrap.min.css" />
		<link rel="stylesheet" type="text/css" href="__CSS__/common.css" />
		<link rel="stylesheet" type="text/css" href="__CSS__/publicSty.css" />
		<link rel="stylesheet" type="text/css" href="__CSS__/page_element.css" />
		<link rel="stylesheet" type="text/css" href="__CSS__/pages-sty.css" />
        <link rel="stylesheet" type="text/css" href="__CSS__/adjust_IE8.css" />
		<script src="__JS__/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="__JS__/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="__JS__/page_sty_is.js" type="text/javascript" charset="utf-8"></script>
		<!-- layer这个JS页面中不需要引入 在父页中已经引入了 这里只是为了测试效果 -->
		<script type="text/javascript" src="__JS__/layer/layer.js"></script>
		<!-- layer这个JS页面中不需要引入 在父页中已经引入了 这里只是为了测试效果 -->
		<script type="text/javascript" src="__JS__/ronshn.js"></script>
		<script type="text/javascript" src="__JS__/ronshn.table.js"></script>
		<title>资产报废报损查询-新增</title> 
	</head>

	<body>
		<!--页面内容-->
		<div class="container-fluid notprint">
			<!--页面导航条-->
			<div class="nav notprint">
				<a class="nav-item">固定资产管理 </a>
				<img src="__IMG__/ic_keyboard_arrow_right.png" />
				<a class="nav-item">固定资产查询 </a>
				<img src="__IMG__/ic_keyboard_arrow_right.png" />
				<a class="nav-item">资产报废报损查询 </a>
				<img src="__IMG__/ic_keyboard_arrow_right.png" />
				<a class="nav-item">新增 </a>
				<div class="topbtn fr">
					<span class=" fs-14 boxshow03 top-btn" data-toggle="modal" data-target="#myModal" onclick="showH()">预览</span>
					<span class=" fs-14 boxshow03 top-btn"  onclick="printH()">打印</span>
				</div>
			</div>
			<!--内容-->
			<div class="boxshow02 order-card bgc-1">
				<!--表单标题部分 start-->
				<!--<div class="detaile-top dtable">-->
					<!--<div class="ordernum dtcell">-->
						<!--<div class="dtable date-calender">-->
							<!--<span class="date-calender-name">日期：</span>-->
							<!--<div class="">-->
								<!--<span></span>-->
								<!--<input type="" class="date-calender-input" id="datetime"  info-data="time" value="{$info.time}" />-->
							<!--</div>-->

                        <!--<if condition="$is_supper eq 1"> &lt;!&ndash; 超级管理员选部门 &ndash;&gt;-->
							<!--<span class="date-calender-name">部门：</span>-->
							<!--<div class="">-->
								<!--<span></span>-->
								<!--<select name="" class="position-department-sele bgimg-select" info-data="org_id">-->
									<!--<option value="">请选择</option>-->
									<!--<volist name="top_departs" id="vo">-->
									<!--<option value="{$vo.id}" <if condition="$info['org_id'] eq $vo['id']">selected</if>  >{$vo.fullname}</option>-->
									<!--</volist>-->
								<!--</select>-->
							<!--</div>-->
						<!--</if>-->
						<!--</div>-->
					<!--</div>-->
					<!--<span class="order-tit dtcell">固定资产报废报损申请单</span>-->
					<!--<div class="grounp order-date dtcell">-->
						<!--<span class="fc-2">单号：</span>-->
						<!--<span class="fc-6" info-data="order_sn">{$info.order_sn}</span>-->
					<!--</div>-->
				<!--</div>-->
                <div class="detaile-top dtable">
                    <div class="ordernum dtcell">
                        <div class="dtable date-calender data_change">
                            <span class="date-calender-name">日期：</span>
                            <div class="">
                                <span></span>
                                <input type="" class="date-calender-input" id="datetime"  info-data="time" value="{$info.time}"/>
                            </div>
                        </div>
                    </div>
                    <span class="order-tit dtcell">固定资产报废报损申请单</span>
                    <div class="grounp order-date dtcell">
                        <span class="fc-2">单号：</span>
                        <span class="fc-6" info-data="order_sn">{$info.order_sn}</span>
                    </div>
                </div>
                <div class="exchange_apply width195">
                    <if condition="$is_supper eq 1"> <!-- 超级管理员选部门 -->
                        <span class="date-calender-name fl span_aduit">部门：</span>
                        <div class="">
                            <span></span>
                            <select name="" class="position-department-sele bgimg-select" info-data="org_id"style="width: 150px;">
                                <option value="">请选择</option>
                                <volist name="top_departs" id="vo">
                                <option value="{$vo.id}" <if condition="$info['org_id'] eq $vo['id']">selected</if>  >{$vo.fullname}</option>
                                </volist>
                            </select>
                        </div>
                    </if>
                </div>
				<!--表单标题部分 end-->
				<!--表单内容部分 start-->
				<div class="table-order-box position-r">
					<table class="table table-bordered" id="addList">
						<tr>
							<td class='order-td-width01'></td>
							
							
							<td  field="order_sn"  class='order-td-width01'>资产代码</td>
							<td  field="assets_name" class='order-td-width01'>物品名称</td>
							<td  field="cate_name"   class='order-td-width01'>资产分类</td>
							<td  field="spec" class='order-td-width01'>规格型号</td>
							<td  field="unit" class='order-td-width01'>单位</td>
							<td  field="original_value" class='order-td-width01'>原值</td>
							<td  field="start_date" class='order-td-width01'>购入日期</td>
							<td  field="service_life" class='order-td-width01'>使用年限</td>
						</tr>

						<tr id="tr1">
							<td>
								<div class="wid80">
									<span class="fs-18" onclick="addrow()"> + </span>
									<span class="fs-20" onclick="delrow(this)">-</span>
								</div>
							</td>
							
							<td class="position-r">
								<input type="text" class="input-td"   />
							
							</td>
							<td class="position-r">
								<input type="text" class="input-td" readonly="true" />
							
							</td>
							<td class="position-r">
								<input type="text" class="input-td" readonly="true" />
								
							</td>
							<td class="position-r">
								<input type="text" class="input-td" readonly="true" />
							
							</td>
							<td class="position-r">
								<input type="text" class="input-td" readonly="true" />
								
							</td>

							<td class="position-r">
								<input type="text" class="input-td" readonly="true" />
								
							</td>
							<td class="position-r">
								<input type="text" class="input-td"  readonly="true" />
							
							</td>
							<td class="position-r">
								<input type="text" class="input-td" readonly="true" />
							</td>
						</tr>

						<volist name="goods_lists" id="vo">
						<tr id="tr1">
							<td>
								<div class="wid80">
									<span class="fs-18" onclick="addrow()"> + </span>
									<span class="fs-20" onclick="delrow(this)">-</span>
								</div>
							</td>
							
							<td class="position-r">
								<input type="text" class="input-td" info-e{$key}="order_sn" value="{$vo.order_sn}" />
							
							</td>
							<td class="position-r">
								<input type="text" class="input-td" info-e{$key}="assets_name" value="{$vo.assets_name}" readonly="true"/>
							
							</td>
							<td class="position-r">
								<input type="text" class="input-td" info-e{$key}="cate_name" value="{$vo.cate_name}" readonly="true"/>
								
							</td>
							<td class="position-r">
								<input type="text" class="input-td" info-e{$key}="spec" value="{$vo.spec}" />
							
							</td>
							<td class="position-r">
								<input type="text" class="input-td" info-e{$key}="unit" value="{$vo.unit}" readonly="true"/>
								
							</td>

							<td class="position-r">
								<input type="text" class="input-td" info-e{$key}="original_value" value="{$vo.original_value}" readonly="true"/>
								
							</td>
							<td class="position-r">
								<input type="text" class="input-td" info-e{$key}="start_date" value="{$vo.start_date}"  readonly="true"/>
							
							</td>
							<td class="position-r">
								<input type="text" class="input-td" info-e{$key}="service_life" value="{$vo.service_life}" readonly="true"/>
							</td>
						</tr>
						</volist>
						
					</table>
					<table class="table table-bordered" id="opinin">
						<tr>
							<td colspan="6" style="padding: 0 ;">
								<div class="opinion-row dtable width-all">
									<div class="order-td-width03 bord-r dtcell vtm"> 变更说明 </div>
									<div class="dtcell vtm pad15">
										<div class="dtable fl">
											<div class="dtcell audit-person">
												<div class="radiocheckitem  fs-16">
													<input type="radio" id="fail"  <if condition="$info['remark'] eq '维修失败'">checked="checked"</if> name="changeCase" value="维修失败" info-data="status">
													<label name="changeCase" class="label-agree  <if condition="$info['remark'] eq '维修失败'">label-checked</if>" for="fail">维修失败</label>
												</div>
												<div class="radiocheckitem fs-16">
													<input type="radio" id="fault" <if condition="$info['remark'] eq '故障'">checked="checked"</if> name="changeCase" value="故障" info-data="status">
													<label class="label-agree <if condition="$info['remark'] eq '故障'">label-checked</if>" name="changeCase" for="fault">故障</label>
												</div>
												<div class="radiocheckitem fs-16">
													<input type="radio" id="expire" <if condition="$info['remark'] eq '到期'">checked="checked"</if> name="changeCase" value="到期" info-data="status">
													<label class="label-agree <if condition="$info['remark'] eq '到期'">label-checked</if>" name="changeCase" for="expire">到期</label>
												</div>
												<div class="radiocheckitem fs-16">
													<input type="radio" id="other" <if condition="($info['remark'] neq '维修失败') AND  ($info['remark'] neq '故障') AND  ($info['remark'] neq '到期')">checked="checked"</if> name="changeCase" value="其他" info-data="status">
													<label class="label-agree <if condition="($info['remark'] neq '维修失败') AND  ($info['remark'] neq '故障') AND  ($info['remark'] neq '到期')">label-checked</if>" name="changeCase" for="other">其他</label>
												</div>
											</div>
										</div>
										<div class="position-r fr wtd-half">
											<span class="prompt-text position-a fc-7">
												<if condition="($info['remark'] neq '维修失败') AND  ($info['remark'] neq '故障') AND  ($info['remark'] neq '到期')">{$info.remark}</if>	
											</span>
											<textarea class="textarea-block bgc-2" rows="2" onkeyup="changePlacehoder(this)" info-data="reason"></textarea>
											<input type="text" style="display:none;">
										</div>
									</div>
								</div>
							</td>
						</tr>
						<volist name="audits_lists" id = "v">	
						
						<!--<tr id="add" class="not_dele"  key="{$key}">-->
							<!--<td colspan="6" style="padding: 0 ;">-->
								<!--<div class="opinion-row dtable width-all">-->
									<!--<div class="order-td-width02 bord-r dtcell vtm">意见</div>-->
									<!--<div class="dtcell pad15 bord-r">-->

										<!--<div class="width-all">-->
											<!--<div class="position-r">-->
												<!--<span class="prompt-text position-a fc-7">原因说明</span>-->
												<!--<textarea class=" textarea-block bgc-2" rows="3" onkeyup="changePlacehoder(this)"></textarea>-->
												<!--<input type="text" style="display:none;">-->
											<!--</div>-->

											<!--<div class="width-all">-->
												<!--<div class="department">-->
													<!--<select name="" class="position-department-sele bgimg-select" info-data="depart_id">-->
													        <!--<option value="">请选择</option>-->
													    <!--<volist name="departs" id="vo">-->
															<!--<option value="{$vo.id}" <if condition="$vo['id'] eq $v['depart_id']">selected</if> >{$vo.fullname}</option>-->
														<!--</volist>-->
													<!--</select>-->
													<!--<div class="dsplin signature">-->
														<!--<div class="signature01" style="top: 0;">-->
															<!--<span class="signature-mask spanhgt">自动签章</span>-->
															<!--<input type="text" class="signature-input sihgt pad15 width-all" onkeyup="changePlacehoder(this)" />-->
															<!--<input type="text" style="display:none;">-->

														<!--</div>-->
														<!--<input type="" placeholder="vvvvvv" name="" id="" value="" />-->
													<!--</div>-->
												<!--</div>-->
												<!--<div class="text-right padr15">-->
													<!--<div class="audit-person">-->
														<!--<div class="radiocheckitem  fs-16">-->
															<!--<input type="radio" id="agree"  name="agreeyorn" value="agree">-->
															<!--<label name="agreeyorn" class="label-agree" for="agree">同意</label>-->
														<!--</div>-->
														<!--<div class="radiocheckitem fs-16">-->
															<!--<input type="radio" id="disagree" name="agreeyorn" value="disagree">-->
															<!--<label class="label-agree" name="agreeyorn" for="disagree">不同意</label>-->
														<!--</div>-->
														<!--&lt;!&ndash; <div class="dsplin change-date-box fs-12 fc-2">-->
															<!--<span>日期：</span>-->
															<!--<input type="text"  id="time" readonly class="change-date" />-->
														<!--</div> &ndash;&gt;-->
													<!--</div>-->
												<!--</div>-->
											<!--</div>-->
										<!--</div>-->
									<!--</div>-->
									<!--<div class="dtcell position-r">-->
										<!--<div class="bgc-2 position-a width-all delete-opinion"  >操作</div>-->
										<!--<div>-->
											<!--<a onclick="delTr(this)" class="opinion-dlt-a">删除</a>-->
										<!--</div>-->
									<!--</div>-->
								<!--</div>-->
							<!--</td>-->
						<!--</tr>-->
                            <tr id="add" class="not_dele"  key="{$key}">
                                <td colspan="6" style="padding: 0 ;">
                                    <div class="opinion-row dtable width-all">
                                        <div class="order-td-width02 bord-r dtcell vtm width240">意见</div>
                                        <div class="dtcell pad15 bord-r">

                                            <div class="width-all">
                                                <div class="position-r">
                                                    <span class="prompt-text position-a fc-7">原因说明</span>
                                                    <textarea class="box_show_none textarea-block bgc-2 border-top_none border-left_none border-right_none" rows="3" onkeyup="changePlacehoder(this)"></textarea>
                                                    <input type="text" style="display:none;">
                                                </div>

                                                <div class="width-all">
                                                    <div class="department">
                                                        <select name="" class="position-department-sele bgimg-select120 fl bgimg-select" info-data="depart_id">
                                                            <option value="">请选择</option>
                                                            <volist name="departs" id="vo">
                                                            <option value="{$vo.id}" <if condition="$vo['id'] eq $v['depart_id']">selected</if> >{$vo.fullname}</option>
                                                            </volist>
                                                        </select>
                                                        <div class="dsplin signature notprint fl_ie">
                                                            <div class="signature01" style="top: 0;">
                                                                <span class="signature-mask spanhgt">自动签章</span>
                                                                <input type="text" class="signature-input sihgt pad15 width-all" onkeyup="changePlacehoder(this)" />
                                                                <input type="text" style="display:none;">

                                                            </div>
                                                            <input type="" placeholder="vvvvvv" name="" id="" value="" />
                                                        </div>
                                                    </div>
                                                    <div class="text-right padr15">
                                                        <div class="audit-person">
                                                            <div class="radiocheckitem  fs-16">
                                                                <input type="radio" id="agree"  name="agreeyorn" value="agree">
                                                                <label name="agreeyorn" class="label-agree" for="agree">同意</label>
                                                            </div>
                                                            <div class="radiocheckitem fs-16">
                                                                <input type="radio" id="disagree" name="agreeyorn" value="disagree">
                                                                <label class="label-agree" name="agreeyorn" for="disagree">不同意</label>
                                                            </div>
                                                            <!-- <div class="dsplin change-date-box fs-12 fc-2">
                                                                <span>日期：</span>
                                                                <input type="text"  id="time" readonly class="change-date" />
                                                            </div> -->
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="dtcell position-r width120">
                                            <div class="bgc-2 position-a position-a_top0 width-all delete-opinion">操作</div>
                                            <div>
                                                <a onclick="delTr(this)" class="opinion-dlt-a dele_IE">删除</a>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
						</volist>

					</table>
					<div class="addlistrow text-center fs-20 fr IE_add_ico margin-top--20" onclick="addOpinion('#add','#opinin')">+</div>
				</div>
				<input type="hidden" name="id" value="{$info.id}" info-data="id"><!-- 隐藏域 -->
				<!--表单内容部分 end-->
				<div class="textcenter mrg-t50 notprint">
					<span class="back-btn dpl fs-16 boxshow03" poster="info" action="__SELF__" >提交</span>
				</div>
			</div>

		</div>
		<div class="modal fade notprint" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	  <div class="modal-dialog"  style="width: 940px;">
	    <div class="modal-content">
			<div class="modal-body">

			</div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-default" data-dismiss="modal">返回</button>
	      </div>
	    </div>
	  </div>
	</div>
	</body>

</html>
<!-- 时间插件 -->
<link rel="stylesheet" href="__JS__/datetimepicker/css/datetimepicker.css" />
<link rel="stylesheet" href="__JS__/datetimepicker/css/datetimepicker_blue.css" />
<link rel="stylesheet" href="__JS__/datetimepicker/css/dropdown.css" />
<script src="__JS__/datetimepicker/js/bootstrap-datetimepicker.js" type="text/javascript"></script>
<script src="__JS__/datetimepicker/js/locales/bootstrap-datetimepicker.zh-CN.js" type="text/javascript"></script>
	<script type="text/javascript">

		//Table类(包含调焦点)
		var t=new Table('#addList',{submit:'info',input:'order_sn',data:'{:U('Scrap/getData')}',datatype:'post'}).addrow();
		function addrow(){t.addrow();}
		function delrow(o){t.delrow($(o).parents('tr'));}

		</script>
<!-- 时间插件 -->
<script>
		$(function() {

				$('#datetime').datetimepicker({
					format: 'yyyy-mm-dd',
					language:"zh-CN",
					minView:2,
					todayBtn:  1,
					autoclose:true
			    });			
				$('#time').datetimepicker({
					format: 'yyyy-mm-dd',
					language:"zh-CN",
					minView:2,
					todayBtn:  1,
					autoclose:true
			    });

			    $('#submit').click(function(){
			    	$("form").submit();
			    })
			  
			})

			radioChecked("changeCase");
			function BindEnter(obj){
				if(obj.keyCode == 13)

				    {
				        $("#submit").click()
				    }
				}

			function delTr(obj){
				// if ( $(obj).parents('tr').hasClass('not_dele') ) {
				// 	return;
				// }
				if ( $(obj).parents('tr').attr('key') == 0 ) {
					return;
				}
               $(obj).parents('tr').remove();
			}

				
			function printH() {
				var selectarr=[];//克隆出来的select没有选中状态
				$('select').each(function(){
					var c=$(this).find('option:selected');
					if (c.val()&&c.val()!=0) {
						selectarr.push($(this).find('option:selected').text())
					}else{
						selectarr.push(' ')
					}
					
				})
				var pr=$('.prinrH');
				if (pr.size()>0) {
					pr.html('');
				}else{
					pr=$('<div class="prinrH"></div>');
					$('body').append(pr);
				}

				var html=$('.order-card').clone(true);
				html.removeClass('order-card')
				pr.append(html);
				pr.find('.notprint').remove();
				pr.find('input').each(function(){
					var type=$(this).attr('type');
					if (type=='radio') {
						return true;
					}else{
						if ($(this).hasClass('Prdate')) {
							$(this).replaceWith('<p style="display:inline-block;width:130px"></p>')
						}else{
							$(this).replaceWith($(this).val())
						}
					}
				});
				pr.find('textarea').each(function(){
					$(this).replaceWith('<div style="height:70px"></div>')
				});
				pr.find('select').each(function(i){
					$(this).replaceWith('<span>部门：'+selectarr[i]+'</span>')
				});
				pr.find('table').each(function(){
					$(this).removeClass('.table-bordered');
					$(this).attr({'border':'1'})
				});
				pr.find('td').each(function(){
					$(this).css('border','none');
				});
				window.print();
			}
			function showH(){
				$('#myModal .modal-body .showHtml').remove();
				var selectarr=[];//克隆出来的select没有选中状态
				$('select').each(function(){
					var c=$(this).find('option:selected');
					if (c.val()&&c.val()!=0) {
						selectarr.push($(this).find('option:selected').text())
					}else{
						selectarr.push(' ')
					}
					
				})
				var pr=$('.showHtml');
				if (pr.size()>0) {
					pr.html('');
				}else{
					pr=$('<div class="showHtml"></div>');
					$('#myModal .modal-body').append(pr);
				}

				var html=$('.order-card').clone(true);
				html.removeClass('order-card');
				pr.append(html);
				pr.find('.notprint').remove();
				pr.find('input').each(function(){
					var type=$(this).attr('type');
					if (type=='radio') {
						return true;
					}else{
						if ($(this).hasClass('Prdate')) {
							$(this).replaceWith('<p style="display:inline-block;width:130px"></p>')
						}else{
							$(this).replaceWith($(this).val())
						}
					}
				});
				pr.find('textarea').each(function(){
					$(this).replaceWith('<div style="height:70px"></div>')
				});
				pr.find('select').each(function(i){
					$(this).replaceWith('<span>部门：'+selectarr[i]+'</span>')
				});
				// pr.find('table').each(function(){
				// 	$(this).removeClass('.table-bordered');
				// 	$(this).attr({'border':'1'})
				// });
				// pr.find('td').each(function(){
				// 	$(this).css('border','none');
				// });

			}
</script>