<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="keywords" content="">
    <meta name="author" content="xx_xh">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/css/common.css"/>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/css/publicSty.css"/>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/css/page_element.css"/>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/css/pages-sty.css"/>
    <script src="__PUBLIC__/js/jquery.min.js" type="text/javascript"></script>
    <script src="__PUBLIC__/js/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="__PUBLIC__/js/page_sty_is.js" type="text/javascript" charset="utf-8"></script>
    <script src="__PUBLIC__/js/ronshn.js" type="text/javascript" charset="utf-8"></script>
    <script src="__PUBLIC__/js/layer/layer.js" type="text/javascript" charset="utf-8"></script>
    <title>费用报销清单-编辑</title>
    <script type="text/javascript">
        $(function () {
            var numtr = document.getElementById("tableFrame").rows.length - 3;
            // alert(numtr)
            document.getElementById("reason").setAttribute("rowspan", numtr)
        })
    </script>
    <style>
        input, textarea, a, select {
            width: 100%;
            height: 100%;
            text-align: center;
        }
    </style>
</head>

<body>
<form action="" method="post">
    <!--页面内容-->
    <div class="container-fluid notprint">
        <!--页面导航条-->
        <div class="nav notprint">
            <a class="nav-item">固定资产管理 </a>
            <img src="__PUBLIC__/images/ic_keyboard_arrow_right.png"/>
            <a class="nav-item">固定资产查询 </a>
            <img src="__PUBLIC__/images/ic_keyboard_arrow_right.png"/>
            <a class="nav-item">报销单 </a>
            <img src="__PUBLIC__/images/ic_keyboard_arrow_right.png"/>
            <a class="nav-item">编辑 </a>
            <div class="topbtn fr">
                <span class=" fs-14 boxshow03 top-btn" data-toggle="modal" data-target="#myModal"
                      onclick="showH()">预览</span>
                <span class=" fs-14 boxshow03 top-btn" onclick="printH()">打印</span>
            </div>
        </div>
        <!--内容-->
        <div class="boxshow02 order-card bgc-1">
            <!--表单标题部分 start-->
            <div class="detaile-top dtable">
                <div class="ordernum dtcell">
                    <div class="dtable date-calender order-td-width02">
                        <span class="date-calender-name">报销日期：</span>
                        <div class="">
                            <span></span>
                            <input type="text" class="date-calender-input bgc-2 boxshow06" ni="time" id="bxdate"
                                   disabled="disabled" value="<?php echo date('Y-m-d',$detail['time']);?>"/>
                        </div>
                    </div>
                </div>
                <span class="order-tit dtcell">费用报销清单</span>
                <div class="grounp order-date dtcell">
                    <div class="dtable date-calender order-td-width02">
                       
                        <div class="">
                            <select ni="department" class="date-calender-input bgc-2 boxshow06">
                                <option value="">选择使用单位</option>
                                <?php foreach($depart as $v):?>
                                <option <?php if($v['id']==$detail['department']):?>selected="selected" <?php endif;?>value="<?php echo $v['id']?>"><?php echo $v['fullname']?></option>
                                <?php endforeach;?>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <!--表单标题部分 end-->
            <!--表单内容部分 start-->
            <div class="table-order-box">
                <table class="table table-bordered" id="tableFrame">
                    <tr>
                        <td rowspan="2" class="width-333 vtm">用途</td>
                        <td colspan="2" class="width-333 vtm">报销数量</td>
                        <td rowspan="2" class="width-333 vtm">财务科审核意见</td>
                    </tr>
                    <tr>
                        <td class="width-167">单据张数</td>
                        <td class="width-167" onclick="changePlacehoder()">金额</td>
                    </tr>
                    <tr>

                    <?php foreach($list as $k=>$v):?>
                        <?php if($k==0):?>
                        <td><input type="text" ni="useto[]" value="<?php echo $v['useto']?>"></td>
                        <td><input type="text" ni="amount[]" value="<?php echo $v['amount']?>"></td>
                        <td><input type="text" ni="money[]" value="<?php echo $v['money']?>"></td>
                        <?php endif;?>
                    <?php endforeach?>
                        <td id="reason">
                            <div class="position-r width-all">
                                <span class="prompt-text position-a fc-7">意见</span>
                                <textarea class="textarea-block bgc-2" ni="opinion" rows="5"
                                          onkeyup="changePlacehoder(this)"><?php echo $detail['opinion']?></textarea>
                                <input type="text" style="display:none;">
                            </div>
                        </td>
                    </tr>
                    <?php foreach($list as $k=>$v):?>
                        <?php if($k!=0):?>
                        <tr>
                        <td><input type="text" ni="useto[]" value="<?php echo $v['useto']?>"></td>
                        <td><input type="text" ni="amount[]" value="<?php echo $v['amount']?>"></td>
                        <td><input type="text" ni="money[]" value="<?php echo $v['money']?>"></td>
                        </tr>
                            <?php endif;?>
                    <?php endforeach?>
                    <tr>
                        <td><input type="text" ni="useto[]"></td>
                        <td><input type="text" ni="amount[]"></td>
                        <td><input type="text" ni="money[]"></td>
                    </tr>
                    <tr>
                        <td><input type="text" ni="useto[]"></td>
                        <td><input type="text" ni="amount[]"></td>
                        <td><input type="text" ni="money[]"></td>
                    </tr>
                    <tr>
                        <td><input type="text" ni="useto[]"></td>
                        <td><input type="text" ni="amount[]"></td>
                        <td><input type="text" ni="money[]"></td>
                    </tr>
                    <tr>
                        <td><input type="text" ni="useto[]"></td>
                        <td><input type="text" ni="amount[]"></td>
                        <td><input type="text" ni="money[]"></td>
                    </tr>
                    <tr>
                        <td><input type="text" ni="useto[]"></td>
                        <td><input type="text" ni="amount[]"></td>
                        <td><input type="text" ni="money[]"></td>
                    </tr>
                    <tr>
                        <td><input type="text" ni="useto[]"></td>
                        <td><input type="text" ni="amount[]"></td>
                        <td><input type="text" ni="money[]"></td>
                    </tr>
                    <tr>
                        <td><input type="text" ni="useto[]"></td>
                        <td><input type="text" ni="amount[]"></td>
                        <td><input type="text" ni="money[]"></td>
                    </tr>
                    <tr>
                        <td><input type="text" ni="useto[]"></td>
                        <td><input type="text" ni="amount[]"></td>
                        <td><input type="text" ni="money[]"></td>
                    </tr>
                    <tr>
                        <td><input type="text" ni="useto[]"></td>
                        <td><input type="text" ni="amount[]"></td>
                        <td><input type="text" ni="money[]"></td>
                    </tr>
                    <tr>
                        <td><input type="text" ni="useto[]"></td>
                        <td><input type="text" ni="amount[]"></td>
                        <td><input type="text" ni="money[]"></td>
                    </tr>
                    <tr>
                        <td colspan="6" style="padding: 0;">
                            <table class="width-all">
                                <tr>
                                    <td class="bord-r bord-b">
                                        <div class="order-td-width03 vtm">金额合计（大写）</div>
                                    </td>
                                    <td class="bord-r bord-b">
                                        <div>
                                            <textarea class="wtd-half" rows="2" ni="total_capital"
                                                      style="overflow:auto; "><?php echo $detail['total_capital']?></textarea>
                                            <div class="dsplin " style=" width: 150px;">
                                                <div class=" bgc-2 boxshow06">
                                                    <div class="input-group">
                                                        <span class="input-group-addon">&yen; :</span>
                                                        <input type="text"
                                                               class="form-control-alt01 fc-3 bgc-2 boxshow06" value="<?php echo $detail['total']?>"
                                                               ni="total">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="bord-r bord-b">
                                        <div class="order-td-width03 vtm">课题</div>
                                    </td>
                                    <td class="bord-b">
                                        <textarea class="width-all" rows="3" cols="" ni="topic"><?php echo $detail['topic']?></textarea>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="bord-r">
                                        <div class="order-td-width03 vtm">付讫记录</div>
                                    </td>
                                    <td class="bord-r">
                                        <div class="dtable">

                                            <div class="dtcell ">
                                                <div class="dtable width-all">
                                                    <span class="dtcell dtcl-span">现金：</span>
                                                    <input type="" class="dtcl-input dtcell bgc-2 boxshow06	"
                                                           ni="cash" value="<?php echo $detail['cash']?>" />
                                                </div>

                                            </div>
                                            <div class="dtcell">
                                                <div class="dtable width-all">
                                                    <span class="dtcell dtcl-span">银行：</span>
                                                    <input type="" class="dtcl-input dtcell bgc-2 boxshow06" ni="bank" value="<?php echo $detail['bank']?>"/>
                                                </div>

                                            </div>
                                            <div class="dtcell">
                                                <div class="dtable width-all">
                                                    <span class="dtcell dtcl-span">转账：</span>
                                                    <input type="" class="dtcl-input dtcell bgc-2 boxshow06"
                                                           ni="transfer" value="<?php echo $detail['transfer']?>"/>
                                                </div>

                                            </div>
                                        </div>
                                    </td>
                                    <td class="bord-r">
                                        <div class="order-td-width03 vtm">审核签章</div>
                                    </td>
                                    <td>
                                        <textarea class="width-all" rows="3" cols="" ni="signature"><?php echo $detail['signature']?></textarea>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>

                </table>
                <div class="dtable" style="margin: 20px;">
                    <div class="dtcell">
                        <div class="input-group">
								<span class="input-group-btn">
								<b class="btn btn-default" style="border: 0; border-radius: 0;">单位负责人: </b>
							</span>
                            <input type="text" class="form-control bgc-2 boxshow06" ni="charge" value="<?php echo $detail['charge']?>"
                                   style=" border-radius: 0;">
                        </div>
                    </div>
                    <div class="dtcell">
                        <div class="input-group">
								<span class="input-group-btn">
								<b class="btn btn-default" style="border: 0; border-radius: 0;">保管验收或证明: </b>
							</span>
                            <input type="text" ni="prove" class="form-control bgc-2 boxshow06" value="<?php echo $detail['prove']?>"
                                   style=" border-radius: 0;">
                        </div>
                    </div>
                    <div class="dtcell">
                        <div class="input-group">
								<span class="input-group-btn">
								<b class="btn btn-default" style="border: 0; border-radius: 0;">经报人: </b>
							</span>
                            <input type="text" ni="user" class="form-control bgc-2 boxshow06" value="<?php echo $detail['user']?>"
                                   style=" border-radius: 0;" ni="user">
                        </div>
                    </div>
                </div>
            </div>
            <!--表单内容部分 end-->
            <div class="textcenter mrg-t50 notprint">
            <input type="hidden" value="{$id}" ni='id'>
                <span class="back-btn dpl fs-16 boxshow03" poster="ni" action="<?php echo U('edit')?>">编辑</span>
            </div>
        </div>

    </div>
</form>
<div class="modal fade notprint" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" style="width: 90%;">
        <div class="modal-content">
            <div class="modal-body">

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">返回</button>
            </div>
        </div>
    </div>
</div>
<script src="__JS__/jquery.min.js" type="text/javascript" charset="utf-8"></script>
<script src="__JS__/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
    function printH() {
        var selectarr = [];//克隆出来的select没有选中状态
        $('select').each(function () {
            var c = $(this).find('option:selected');
            if (c.val() && c.val() != 0) {
                selectarr.push($(this).find('option:selected').text())
            } else {
                selectarr.push(' ')
            }

        })
        var pr = $('.prinrH');
        if (pr.size() > 0) {
            pr.html('');
        } else {
            pr = $('<div class="prinrH"></div>');
            $('body').append(pr);
        }

        var html = $('.order-card').clone(true);
        html.removeClass('order-card')
        pr.append(html);
        pr.find('.notprint').remove();
        pr.find('input').each(function () {
            var type = $(this).attr('type');
            if (type == 'radio') {
                return true;
            } else {
                if ($(this).hasClass('Prdate')) {
                    $(this).replaceWith('<p style="display:inline-block;width:130px"></p>')
                } else {
                    $(this).replaceWith($(this).val())
                }
            }
        });
        pr.find('textarea').each(function () {
            $(this).replaceWith('<div style="height:70px"></div>')
        });
        pr.find('select').each(function (i) {
            $(this).replaceWith('<span>部门：' + selectarr[i] + '</span>')
        });
        pr.find('table').each(function () {
            $(this).removeClass('.table-bordered');
            $(this).attr({'border': '1'})
        });
        pr.find('td').each(function () {
            $(this).css('border', 'none');
        });
        window.print();
    }
    function showH() {
        $('#myModal .modal-body .showHtml').remove();
        var selectarr = [];//克隆出来的select没有选中状态
        $('select').each(function () {
            var c = $(this).find('option:selected');
            if (c.val() && c.val() != 0) {
                selectarr.push($(this).find('option:selected').text())
            } else {
                selectarr.push(' ')
            }

        })
        var pr = $('.showHtml');
        if (pr.size() > 0) {
            pr.html('');
        } else {
            pr = $('<div class="showHtml"></div>');
            $('#myModal .modal-body').append(pr);
        }

        var html = $('.order-card').clone(true);
        html.removeClass('order-card');
        pr.append(html);
        pr.find('.notprint').remove();
        pr.find('input').each(function () {
            var type = $(this).attr('type');
            if (type == 'radio') {
                return true;
            } else {
                if ($(this).hasClass('Prdate')) {
                    $(this).replaceWith('<p style="display:inline-block;width:130px"></p>')
                } else {
                    $(this).replaceWith($(this).val())
                }
            }
        });
        pr.find('textarea').each(function () {
            $(this).replaceWith('<div style="height:70px"></div>')
        });
        pr.find('select').each(function (i) {
            $(this).replaceWith('<span>部门：' + selectarr[i] + '</span>')
        });
        // pr.find('table').each(function(){
        // 	$(this).removeClass('.table-bordered');
        // 	$(this).attr({'border':'1'})
        // });
        // pr.find('td').each(function(){
        // 	$(this).css('border','none');
        // });

    }
</script>
</body>

</html>